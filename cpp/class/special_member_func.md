## [index](../README.md)

# Special Member Functions

- generated by compiler
    - special member functions are functions that compiler can generate for you
    - Special member functions along with the comparison operators (since C++20) are the only functions that can be _defaulted_ (using `= default`)
        - declaration of comparison operators cannot be generated by compiler
    - _defaulted_ or compiler-generated version is `inline public` and will be marked `noexcept` and `constexpr` when possible
        - `cnostexpr`/`noexcept` or not is determined by data members and base classes

## Contents

- [Default Constructor (not included in rule of 5)](#default-constructor)
- [Destructor](#destructor)
- [Copy Constructor and Copy Assignment Operator](#copy-constructor-and-copy-assignment-operator)
- [Guideline](#guideline)
- [References](#references)


## Default Constructor

- generated by compiler if _defaulted_ using `= default` or
    - no ctor (whether copy/move ctor or other ctor) is explicitly declared and
    - all data members and base classes can be default constructed
- behavior of compiler-generated version
    - value-init data members if value-init
    - default-init data members if default-init
- __guideline:__
    - avoid writing an empty default constructor (it will never value-init members)
    - use __member initializer list__ and prefer it to assignment in constructors

## Destructor

- generated by compiler if _defaulted_ using `= default` or
    - not explicitly declared
- `default` dtor destroys data members in reverse order
- user-provided dtor is implicitly `noexcept` unless declared as `noexcept(false)`

## Copy Constructor and Copy Assignment Operator

```cpp
Widget(const Widget&);  // the default
Widget(Widget&);        // possible, but very likely not reasonable

Widget& operator=(const Widget&);  // the default
Widget& operator=(Widget&);        // possible, but very likely not reasonable

// reasonable, copy-and-swap idiom
// considered as copy assignment operator by compiler,
// but cannot be declared with = default
Widget& operator=(Widget);         
```
- generated by compiler if _defaulted_ using `= default` or
    - not explicitly declared and
    - all data members and base classes can be copy constructed/assigned and
    - no move operation declared
- every class has a copy ctor and copy assignment op, either they are available or `= delete`
    - `= delete` implicitly if user-declared move operations or having non-copyable members

## Move Constructor and Move Assignment Operator

```cpp
Widget(Widget&&);           // the default
Widget(const Widget&&);     // possible, but very likely not reasonable

Widget& operator=(Widget&&);        // the default
Widget& operator=(const Widget&&);  // possible, but very likely not reasonable
```
- generated by compiler if _defaulted_ using `= default` or
    - not explicitly declared and
    - all data members and base classes can be copy/move constructed/assigned and
    - no dtor and copy operation declared
- class is not required to have move ctor and move assignment op like copy operations do
    - if cannot be generated by compiler and not user-declared, they simply do not exist and do not participate in overload candidate set

## Guideline

- __rule of 5__: if you declare any of destructor, copy/move ctor/assignment op: you should declare all of them
    - justification:
        - if one kind of memberwise resouce operation is not suitable, others would also be not suitable and need to de defined by users.
        - dtor would also be participating in management of the resource
- __rule of 3__: if you only wants copy semantics, you can choose not to declare any move operations
- __rule of 0__: strive to use appropriate types for your member variables so that you do not need to write any of the special member functions

## References

- https://en.cppreference.com/w/cpp/language/member_functions
- [Back To Basics: The Special Member Functions - Klaus Iglberger - CppCon 2021](https://www.youtube.com/watch?v=9BM5LAvNtus)